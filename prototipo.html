<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <title>Button Debug QuestÂ 3S</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene vr-mode-ui="enabled: true">
      <!-- Testo UI per mostrare il bottone premuto -->
      <a-text id="btnLabel" value="Premi un bottone" position="0 2 -1" align="center" color="#FFF"></a-text>

      <!-- Controller sinistro -->
      <a-entity id="leftCtl"
                meta-touch-controls="hand: left"
                button-listener></a-entity>
      <!-- Controller destro -->
      <a-entity id="rightCtl"
                meta-touch-controls="hand: right"
                button-listener></a-entity>

      <!-- Un piano semplice sotto di noi -->
      <a-plane rotation="-90 0 0" width="10" height="10" color="#444"></a-plane>
    </a-scene>

    <script>
      AFRAME.registerComponent('button-listener', {
        init: function () {
          const el = this.el;
          const lbl = document.getElementById('btnLabel');
          const buttons = [
            'trigger', 'grip', 'thumbstick', 'abutton', 'bbutton',
            'xbutton', 'ybutton', 'surface'
          ];
          buttons.forEach(btn => {
            ['down','up','touchstart','touchend'].forEach(evtType => {
              const evtName = btn + evtType;
              el.addEventListener(evtName, e => {
                lbl.setAttribute('value', `${evtName} su ${el.getAttribute('meta-touch-controls').hand}`);
              });
            });
          });
        }
      });
    </script>
  </body>
</html>
